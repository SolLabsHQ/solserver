
> solserver@1.0.0 test /Users/jmcnulty25/.codex/worktrees/9018/solserver
> vitest run --no-file-parallelism --testTimeout 20000


 RUN  v4.0.16 /Users/jmcnulty25/.codex/worktrees/9018/solserver

stdout | test/output_envelope.test.ts
[dotenv@17.2.3] injecting env (0) from .env -- tip: ğŸ” encrypt with Dotenvx: https://dotenvx.com

 âœ“ test/output_envelope.test.ts (10 tests) 945ms
     âœ“ persists output_contract_failed in async completion  904ms
stdout | test/gates.pipeline.test.ts
[dotenv@17.2.3] injecting env (0) from .env -- tip: ğŸ” prevent committing .env to code: https://dotenvx.com/precommit

 âœ“ test/gates.pipeline.test.ts (15 tests) 275ms
{"level":40,"time":1771346523862,"pid":81730,"hostname":"MacBookPro","dbPath":"/Users/jmcnulty25/.codex/worktrees/9018/solserver/data/test_internal_topology.db","expectedVolumePrefix":"/data/","msg":"topology.guard: database not on Fly.io volume (may not be shared across instances)"}
{"level":40,"time":1771346523903,"pid":81730,"hostname":"MacBookPro","dbPath":"/Users/jmcnulty25/.codex/worktrees/9018/solserver/data/test_internal_topology.db","expectedVolumePrefix":"/data/","msg":"topology.guard: database not on Fly.io volume (may not be shared across instances)"}
{"level":40,"time":1771346523924,"pid":81730,"hostname":"MacBookPro","dbPath":"/Users/jmcnulty25/.codex/worktrees/9018/solserver/data/test_internal_topology.db","expectedVolumePrefix":"/data/","msg":"topology.guard: database not on Fly.io volume (may not be shared across instances)"}
{"level":40,"time":1771346523942,"pid":81730,"hostname":"MacBookPro","dbPath":"/Users/jmcnulty25/.codex/worktrees/9018/solserver/data/test_internal_topology.db","expectedVolumePrefix":"/data/","msg":"topology.guard: database not on Fly.io volume (may not be shared across instances)"}
{"level":40,"time":1771346523964,"pid":81730,"hostname":"MacBookPro","dbPath":"/Users/jmcnulty25/.codex/worktrees/9018/solserver/data/test_internal_topology.db","expectedVolumePrefix":"/data/","msg":"topology.guard: database not on Fly.io volume (may not be shared across instances)"}
{"level":40,"time":1771346523984,"pid":81730,"hostname":"MacBookPro","dbPath":"/Users/jmcnulty25/.codex/worktrees/9018/solserver/data/test_internal_topology.db","expectedVolumePrefix":"/data/","msg":"topology.guard: database not on Fly.io volume (may not be shared across instances)"}
 âœ“ test/internal_topology.test.ts (6 tests) 149ms
{"level":30,"time":1771346523863,"pid":81730,"hostname":"MacBookPro","dbPath":"/Users/jmcnulty25/.codex/worktrees/9018/solserver/data/test_internal_topology.db","msg":"topology.guard: validation passed"}
{"level":30,"time":1771346523888,"pid":81730,"hostname":"MacBookPro","evt":"topology.guard.api_primary_key_created","createdAtMs":1771346523888,"createdBy":"api","msg":"topology.guard.api_primary_key_created"}
{"level":30,"time":1771346523924,"pid":81730,"hostname":"MacBookPro","dbPath":"/Users/jmcnulty25/.codex/worktrees/9018/solserver/data/test_internal_topology.db","msg":"topology.guard: validation passed"}
{"level":30,"time":1771346523940,"pid":81730,"hostname":"MacBookPro","evt":"topology.guard.api_primary_key_created","createdAtMs":1771346523940,"createdBy":"api","msg":"topology.guard.api_primary_key_created"}
{"level":30,"time":1771346523942,"pid":81730,"hostname":"MacBookPro","dbPath":"/Users/jmcnulty25/.codex/worktrees/9018/solserver/data/test_internal_topology.db","msg":"topology.guard: validation passed"}
{"level":30,"time":1771346523961,"pid":81730,"hostname":"MacBookPro","evt":"topology.guard.api_primary_key_created","createdAtMs":1771346523961,"createdBy":"api","msg":"topology.guard.api_primary_key_created"}
{"level":30,"time":1771346523964,"pid":81730,"hostname":"MacBookPro","dbPath":"/Users/jmcnulty25/.codex/worktrees/9018/solserver/data/test_internal_topology.db","msg":"topology.guard: validation passed"}
{"level":30,"time":1771346523982,"pid":81730,"hostname":"MacBookPro","evt":"topology.guard.api_primary_key_created","createdAtMs":1771346523982,"createdBy":"api","msg":"topology.guard.api_primary_key_created"}
{"level":30,"time":1771346523903,"pid":81730,"hostname":"MacBookPro","dbPath":"/Users/jmcnulty25/.codex/worktrees/9018/solserver/data/test_internal_topology.db","msg":"topology.guard: validation passed"}
{"level":30,"time":1771346523921,"pid":81730,"hostname":"MacBookPro","evt":"topology.guard.api_primary_key_created","createdAtMs":1771346523921,"createdBy":"api","msg":"topology.guard.api_primary_key_created"}
{"level":30,"time":1771346523984,"pid":81730,"hostname":"MacBookPro","dbPath":"/Users/jmcnulty25/.codex/worktrees/9018/solserver/data/test_internal_topology.db","msg":"topology.guard: validation passed"}
{"level":30,"time":1771346524004,"pid":81730,"hostname":"MacBookPro","evt":"topology.guard.api_primary_key_created","createdAtMs":1771346524003,"createdBy":"api","msg":"topology.guard.api_primary_key_created"}
stdout | test/trace.test.ts
[dotenv@17.2.3] injecting env (0) from .env -- tip: ğŸ”‘ add access controls to secrets: https://dotenvx.com/ops

 âœ“ test/trace.test.ts (12 tests) 118ms
 âœ“ test/lease_claims.test.ts (2 tests) 80ms
stdout | test/restart_continuity.test.ts
[dotenv@17.2.3] injecting env (0) from .env -- tip: ğŸ” prevent committing .env to code: https://dotenvx.com/precommit

 âœ“ test/restart_continuity.test.ts (1 test) 70ms
stdout | test/lattice_retrieval.test.ts
[dotenv@17.2.3] injecting env (0) from .env -- tip: ğŸ› ï¸  run anywhere with `dotenvx run -- yourcommand`

 âœ“ test/lattice_retrieval.test.ts (7 tests) 50ms
stdout | test/thread_memento_latest.test.ts
[dotenv@17.2.3] injecting env (0) from .env -- tip: ğŸ”„ add secrets lifecycle management: https://dotenvx.com/ops

 âœ“ test/thread_memento_latest.test.ts (5 tests) 48ms
stdout | test/driver_blocks.test.ts
[dotenv@17.2.3] injecting env (0) from .env -- tip: âš™ï¸  load multiple .env files with { path: ['.env.local', '.env'] }

 âœ“ test/driver_blocks.test.ts (22 tests) 41ms
stdout | test/memory_routes.test.ts
[dotenv@17.2.3] injecting env (0) from .env -- tip: ğŸ” encrypt with Dotenvx: https://dotenvx.com

 âœ“ test/memory_routes.test.ts (9 tests) 44ms
stdout | test/evidence.test.ts
[dotenv@17.2.3] injecting env (0) from .env -- tip: ğŸ‘¥ sync secrets across teammates & machines: https://dotenvx.com/ops

 âœ“ test/evidence.test.ts (12 tests) 36ms
stdout | src/routes/chat.idempotency.test.ts
[dotenv@17.2.3] injecting env (0) from .env -- tip: ğŸ—‚ï¸ backup and recover secrets: https://dotenvx.com/ops

 âœ“ src/routes/chat.idempotency.test.ts (5 tests) 28ms
stdout | test/librarian_gate.test.ts
[dotenv@17.2.3] injecting env (0) from .env -- tip: ğŸ“¡ add observability to secrets: https://dotenvx.com/ops

 âœ“ test/librarian_gate.test.ts (2 tests) 27ms
 âœ“ test/topology_key.test.ts (1 test) 25ms
 âœ“ test/topology_guard.test.ts (7 tests) 27ms
stdout | src/routes/transmissions.journal_offer.test.ts
[dotenv@17.2.3] injecting env (0) from .env -- tip: ğŸ“¡ add observability to secrets: https://dotenvx.com/ops

 âœ“ src/routes/transmissions.journal_offer.test.ts (2 tests) 25ms
 âœ“ test/evidence_store.test.ts (16 tests) 20ms
 âœ“ test/journal_routes.test.ts (2 tests) 17ms
 âœ“ test/trace_events_routes.test.ts (2 tests) 16ms
 âœ“ src/routes/chat.test.ts (9 tests) 6ms
 âœ“ test/evidence_intake.test.ts (12 tests) 5ms
 âœ“ test/output_envelope_schema.test.ts (13 tests) 6ms
 âœ“ src/contracts/chat.canon-fixture.test.ts (4 tests) 5ms
 âœ“ test/thread_memento_affect.test.ts (1 test) 3ms
stdout | test/memory_distill.test.ts
[dotenv@17.2.3] injecting env (0) from .env -- tip: âš™ï¸  load multiple .env files with { path: ['.env.local', '.env'] }

 âœ“ test/memory_distill.test.ts (4 tests) 3ms
 âœ“ test/timestamp_validation.test.ts (7 tests) 3ms
 âœ“ test/url_extraction.test.ts (14 tests) 3ms
 âœ“ test/url_warnings.test.ts (9 tests) 3ms
 âœ“ test/topology_handshake.test.ts (5 tests) 3ms
 âœ“ test/post_linter.test.ts (9 tests) 3ms
 âœ“ test/prompt_pack.test.ts (3 tests) 2ms
 âœ“ src/control-plane/router.test.ts (3 tests) 2ms
 âœ“ test/journal_offer_classifier.test.ts (7 tests) 2ms
stdout | test/provider_config.test.ts
[dotenv@17.2.3] injecting env (0) from .env -- tip: âœ… audit secrets and track compliance: https://dotenvx.com/ops

 âœ“ test/provider_config.test.ts (4 tests) 2ms
stdout | test/orchestrator.safety_urgent.test.ts
[dotenv@17.2.3] injecting env (0) from .env -- tip: âš™ï¸  write to custom object with { processEnv: myObject }

 âœ“ test/orchestrator.safety_urgent.test.ts (2 tests) 2ms
stdout | test/orchestrator.forced_persona.test.ts
[dotenv@17.2.3] injecting env (0) from .env -- tip: âš™ï¸  enable debug logging with { debug: true }

 âœ“ test/orchestrator.forced_persona.test.ts (1 test) 2ms
 âœ“ test/personas.test.ts (1 test) 1ms
stdout | test/orchestrator.policy_resolution.test.ts
[dotenv@17.2.3] injecting env (0) from .env -- tip: ğŸ‘¥ sync secrets across teammates & machines: https://dotenvx.com/ops

 âœ“ test/orchestrator.policy_resolution.test.ts (4 tests) 1ms
stdout | test/output_envelope_meta.test.ts
[dotenv@17.2.3] injecting env (0) from .env -- tip: ğŸ” encrypt with Dotenvx: https://dotenvx.com

 âœ“ test/output_envelope_meta.test.ts (1 test) 1ms
stdout | test/openai_integration.test.ts
[dotenv@17.2.3] injecting env (0) from .env -- tip: ğŸ” encrypt with Dotenvx: https://dotenvx.com

 â†“ test/openai_integration.test.ts (1 test | 1 skipped)

 Test Files  39 passed | 1 skipped (40)
      Tests  251 passed | 1 skipped (252)
   Start at  08:42:01
   Duration  7.92s (transform 435ms, setup 100ms, import 2.73s, tests 2.10s, environment 3ms)

